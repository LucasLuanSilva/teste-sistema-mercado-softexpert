import{M as g,a as p,b}from"./MoneyInput-D8iU4Hhc.js";import{_ as y,r as I,c as n,b as t,F as u,e as m,w as v,v as V,d as C,o as r,t as i,p as x,a as w}from"./index-BsSQaGFC.js";const P={components:{MoneyInput:g},data(){return{colunas:["Código","Descrição","Valor"],colunasItens:["Código","Descrição","Qtd","Valor","Imposto","Valor Total",""],produtos:[],produtoSelecionado:{},produto:{codigo:"",descricao:"",valor_unitario:"",quantidade:1,imposto_unitario:0},itensVenda:[],modalProdutos:null,totalImposto:0,totalVenda:0,modalVendas:null,colunasVendas:["Código","Data","Imposto","Valor Total"],vendas:[]}},mounted(){this.modalProdutos=new p(document.getElementById("listagemProdutos"),{keyboard:!1}),this.modalVendas=new p(document.getElementById("listagemVendas"),{keyboard:!1})},methods:{cliqueProduto(e,o){var d=document.getElementsByTagName("tr");Array.prototype.forEach.call(d,function(h){h.classList.remove("selected")}),e.target.parentNode.classList.add("selected"),this.produtoSelecionado=o},carregaProdutos(){var e=document.getElementsByTagName("tr");Array.prototype.forEach.call(e,function(o){o.classList.remove("selected")}),this.produtoSelecionado={},b.get("http://localhost:8080/produto").then(o=>{this.produtos=o.data}).catch(o=>{console.log(o)})},abrirModalProdutos(){var e=document.getElementsByTagName("tr");Array.prototype.forEach.call(e,function(o){o.classList.remove("selected")}),this.produtoSelecionado={},this.carregaProdutos(),this.modalProdutos.show()},abrirModalVendas(){this.carregaVendas(),this.modalVendas.show()},setProduto(){this.produto={codigo:this.produtoSelecionado.codigo,descricao:this.produtoSelecionado.descricao,valor_unitario:this.produtoSelecionado.valor_unitario,quantidade:1,imposto_unitario:this.produtoSelecionado.imposto_unitario},this.modalProdutos.hide()},validaCamposItem(e,o){let d="";return e>0?o>0||(d="Informe uma quantidade válida."):d="Informe um produto.",d},incluirItem(){let e=this.validaCamposItem(this.produto.codigo,this.produto.quantidade);if(e!=""){alert(e);return}this.itensVenda.push(this.produto),this.produto={codigo:"",descricao:"",valor_unitario:"",quantidade:1,imposto_unitario:0},this.totalizaVenda()},excluirItem(e){let o=[];for(var d in this.itensVenda)e!=d&&o.push(this.itensVenda[d]);this.itensVenda=o,this.totalizaVenda()},totalizaVenda(){let e=0,o=0;this.itensVenda.forEach(d=>{o+=Number(d.quantidade)*Number(d.valor_unitario),e+=Number(d.quantidade)*Number(d.valor_unitario)*(Number(d.imposto_unitario)/100)}),this.totalImposto=e,this.totalVenda=o+e},formatarValor(e){return Number(e).toLocaleString("pt-br",{maximumFractionDigits:2,minimumFractionDigits:2})},formatarData(e){const o=new Date(e);if(isNaN(o.getTime()))return"Data inválida!";const d=("0"+o.getDate()).slice(-2),h=("0"+(o.getMonth()+1)).slice(-2),l=o.getFullYear();return`${d}/${h}/${l}`},finalizarVenda(){if(!(this.itensVenda.length>0)){alert("Inclua ao menos um item ao pedido.");return}let e={itens:this.itensVenda,imposto:this.totalImposto,valor:this.totalVenda};b.post("http://localhost:8080/venda",e).then(o=>{console.log(o),alert("Venda finalizada com sucesso!"),this.cancelarVenda()}).catch(o=>{console.log(o)})},cancelarVenda(){this.itensVenda=[],this.totalVenda=0,this.totalImposto=0},carregaVendas(){b.get("http://localhost:8080/venda").then(e=>{this.vendas=e.data}).catch(e=>{console.log(e)})}}},c=e=>(x("data-v-31d2f427"),e=e(),w(),e),D={id:"venda"},k={class:"modal fade",id:"listagemProdutos","data-bs-backdrop":"static","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"listagemProdutosLabel","aria-hidden":"true"},q={class:"modal-dialog"},S={class:"modal-content"},N=c(()=>t("div",{class:"modal-header"},[t("h1",{class:"modal-title fs-5",id:"listagemProdutosLabel"},"Selecione um produto"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),M={class:"modal-body"},T={class:"row"},E={class:"table table-default border"},L={scope:"col"},B=["onClick"],z={class:"modal-footer"},F={class:"modal modal-lg fade",id:"listagemVendas","data-bs-backdrop":"static","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"listagemVendasLabel","aria-hidden":"true"},Q={class:"modal-dialog"},U={class:"modal-content"},A=c(()=>t("div",{class:"modal-header"},[t("h1",{class:"modal-title fs-5",id:"listagemVendasLabel"},"Vendas"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),j={class:"modal-body"},O={class:"row"},R={class:"table table-default border"},Y={scope:"col"},G=c(()=>t("div",{class:"row"},[t("div",{class:"col-6"},[t("h5",null,"Itens venda")]),t("div",{class:"col-6"},[t("h5",null,"Incluir Produto")])],-1)),H={class:"row"},J={id:"containerProdutos",class:"col-6"},K={class:"table border"},W={scope:"col"},X=["onClick"],Z={class:"col-6"},$={class:"row"},tt={class:"col-2"},ot=c(()=>t("label",{for:"inputCodigo"},"Cód.",-1)),at={class:"input-group mb-3"},et={class:"col-5"},st=c(()=>t("label",{for:"inputDescricao"},"Descrição",-1)),lt={class:"col-2"},dt=c(()=>t("label",{for:"inputValor"},"Valor",-1)),it=["value"],nt={class:"col-2"},rt=c(()=>t("label",{for:"inputQuantidade"},"Qtd.",-1)),ct={class:"col-1"},ut=c(()=>t("hr",null,null,-1)),mt={class:"row"},ht={class:"col-6"},_t=c(()=>t("label",{for:"inputTotalImposto"},"Total Impostos",-1)),bt=["value"],pt={class:"col-6"},vt=c(()=>t("label",{for:"inputTotalVenda"},"Total Venda",-1)),Vt=["value"],ft={class:"row mt-4"},gt={class:"col-12"},yt={class:"row mt-2"},It={class:"col-12"},Ct={class:"row mt-2"},xt={class:"col-12"};function wt(e,o,d,h,l,s){const f=I("MoneyInput");return r(),n("div",D,[t("div",k,[t("div",q,[t("div",S,[N,t("div",M,[t("div",T,[t("table",E,[t("thead",null,[t("tr",null,[(r(!0),n(u,null,m(l.colunas,a=>(r(),n("th",L,i(a),1))),256))])]),t("tbody",null,[(r(!0),n(u,null,m(l.produtos,a=>(r(),n("tr",{onClick:_=>s.cliqueProduto(_,a)},[t("td",null,i(a.codigo),1),t("td",null,i(a.descricao),1),t("td",null,i(s.formatarValor(a.valor_unitario)),1)],8,B))),256))])])])]),t("div",z,[t("button",{type:"button",onClick:o[0]||(o[0]=(...a)=>s.setProduto&&s.setProduto(...a)),class:"btn btn-success"},"Confirmar")])])])]),t("div",F,[t("div",Q,[t("div",U,[A,t("div",j,[t("div",O,[t("table",R,[t("thead",null,[t("tr",null,[(r(!0),n(u,null,m(l.colunasVendas,a=>(r(),n("th",Y,i(a),1))),256))])]),t("tbody",null,[(r(!0),n(u,null,m(l.vendas,a=>(r(),n("tr",null,[t("td",null,i(a.codigo),1),t("td",null,i(s.formatarData(a.data_inclusao)),1),t("td",null,i(s.formatarValor(a.imposto)),1),t("td",null,i(s.formatarValor(a.valor)),1)]))),256))])])])])])])]),G,t("div",H,[t("div",J,[t("table",K,[t("thead",null,[t("tr",null,[(r(!0),n(u,null,m(l.colunasItens,a=>(r(),n("th",W,i(a),1))),256))])]),t("tbody",null,[(r(!0),n(u,null,m(l.itensVenda,(a,_)=>(r(),n("tr",null,[t("td",null,i(a.codigo),1),t("td",null,i(a.descricao),1),t("td",null,i(s.formatarValor(a.quantidade)),1),t("td",null,i(s.formatarValor(a.valor_unitario)),1),t("td",null,i(s.formatarValor(a.quantidade*a.valor_unitario*(a.imposto_unitario/100))),1),t("td",null,i(s.formatarValor(a.quantidade*a.valor_unitario+a.quantidade*a.valor_unitario*(a.imposto_unitario/100))),1),t("td",{onClick:Pt=>s.excluirItem(_),id:"excluirItem",style:{color:"red","font-weight":"bold"}},"x",8,X)]))),256))])])]),t("div",Z,[t("div",$,[t("div",tt,[ot,t("div",at,[t("button",{style:{width:"30px",margin:"0px",padding:"4px"},class:"btn btn-primary",type:"button",id:"button-addon1",onClick:o[1]||(o[1]=(...a)=>s.abrirModalProdutos&&s.abrirModalProdutos(...a))},"🔍"),v(t("input",{id:"inputCodigo",type:"text",class:"form-control","aria-describedby":"button-addon1","onUpdate:modelValue":o[2]||(o[2]=a=>l.produto.codigo=a),disabled:""},null,512),[[V,l.produto.codigo]])])]),t("div",et,[st,v(t("input",{id:"inputDescricao",type:"text",class:"form-control","onUpdate:modelValue":o[3]||(o[3]=a=>l.produto.descricao=a),disabled:""},null,512),[[V,l.produto.descricao]])]),t("div",lt,[dt,t("input",{id:"inputValor",type:"text",class:"form-control",value:s.formatarValor(l.produto.valor_unitario),disabled:""},null,8,it)]),t("div",nt,[rt,C(f,{id:"inputQuantidade",class:"form-control",modelValue:l.produto.quantidade,"onUpdate:modelValue":o[4]||(o[4]=a=>l.produto.quantidade=a),value:l.produto.quantidade,options:{locale:"pt-BR",currency:"USD",currencyDisplay:"hidden",precision:2,autoDecimalDigits:!0}},null,8,["modelValue","value"])]),t("div",ct,[t("button",{style:"margin-top: 23px;",onClick:o[5]||(o[5]=(...a)=>s.incluirItem&&s.incluirItem(...a)),type:"button",class:"btn btn-success"}," ✓ ")])]),ut,t("div",mt,[t("div",ht,[_t,t("input",{id:"inputTotalImposto",type:"text",class:"form-control",value:s.formatarValor(l.totalImposto),disabled:""},null,8,bt)]),t("div",pt,[vt,t("input",{id:"inputTotalVenda",type:"text",class:"form-control",value:s.formatarValor(l.totalVenda),disabled:""},null,8,Vt)])]),t("div",ft,[t("div",gt,[t("button",{onClick:o[6]||(o[6]=(...a)=>s.finalizarVenda&&s.finalizarVenda(...a)),type:"button",class:"btn btn-success btn-large"}," Finalizar Venda ")])]),t("div",yt,[t("div",It,[t("button",{onClick:o[7]||(o[7]=(...a)=>s.cancelarVenda&&s.cancelarVenda(...a)),type:"button",class:"btn btn-warning text-white btn-large"}," Cancelar Venda ")])]),t("div",Ct,[t("div",xt,[t("button",{onClick:o[8]||(o[8]=(...a)=>s.abrirModalVendas&&s.abrirModalVendas(...a)),type:"button",class:"btn btn-primary btn-large"}," Vendas ")])])])])])}const qt=y(P,[["render",wt],["__scopeId","data-v-31d2f427"]]);export{qt as default};
